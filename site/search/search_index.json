{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Single-cell RNA-seq workflow documentation (CMSE Reproducible Computational Workflow)","text":"<p>This site documents my reproducible single-cell RNA-seq (scRNA-seq) workflow for dissertation projects. The analysis is implemented in R using Monocle3 for the input data format and Seurat for downstream analysis (normalization, clustering, marker genes, and visualization).</p> <p>If you are starting from raw reads instead of a processed object, see: https://www.sc-best-practices.org/introduction/raw_data_processing.html</p> <p>Most of the functions here are included in R package Seurat, detailed resources can be found here: https://cole-trapnell-lab.github.io/monocle3/docs/getting_started/</p>"},{"location":"#project-structure-whats-in-this-repository","title":"Project structure (what\u2019s in this repository)","text":"<ul> <li><code>main.Rmd</code> \u2014 the main reproducible report that runs the pipeline end-to-end</li> <li><code>R scripts/</code> \u2014 modular R scripts for each pipeline stage (load, convert, preprocess, markers, annotation, saving)</li> <li><code>data/embryo_11dpf/</code> \u2014 input directory containing <code>cds_object.rds</code> (Monocle3 <code>cell_data_set</code>)</li> <li><code>output/</code> \u2014 results saved by the pipeline (tables, plots, objects, session info)</li> <li><code>tests/testthat/</code> \u2014 unit tests for key pipeline functions (run with testthat)</li> <li><code>docs/</code> \u2014 MkDocs documentation pages (this website)</li> </ul>"},{"location":"#how-to-run-the-workflow","title":"How to run the workflow","text":""},{"location":"#render-the-analysis-report-recommended","title":"Render the analysis report (recommended)","text":"<p>From the project root in R:</p> <p>```r rmarkdown::render(\"main.Rmd\")</p>"},{"location":"inputs/","title":"Inputs","text":""},{"location":"inputs/#required-input-directory","title":"Required input directory","text":"<p>This pipeline expects a directory containing a Monocle3 object:</p> <ul> <li><code>data/embryo_11dpf/</code></li> <li><code>cds_object.rds</code> (required): Monocle3 <code>cell_data_set</code></li> <li><code>file_index.rds</code> (optional): not used by the pipeline, included with dataset packaging</li> </ul> <p>The loader function reads:</p> <p><code>data/embryo_11dpf/cds_object.rds</code></p>"},{"location":"inputs/#what-is-a-cell_data_set","title":"What is a <code>cell_data_set</code>?","text":"<p>A <code>cell_data_set</code> (CDS) is Monocle3\u2019s main object for single-cell data. It contains:</p> <ul> <li>a gene-by-cell count matrix (assay: <code>counts</code>)</li> <li>cell metadata (e.g., sample, embryo, UMI counts)</li> <li>optional reduced dimensions (PCA/UMAP) stored in the object</li> </ul>"},{"location":"inputs/#input-assumptions","title":"Input assumptions","text":"<ul> <li>The CDS contains an assay named <code>counts</code></li> <li>Cell metadata is stored in <code>colData(cds)</code></li> <li>Genes are stored as rows (features); cells are columns</li> </ul>"},{"location":"outputs/","title":"Outputs","text":"<p>All results from the pipeline are saved to the output directory specified in <code>main.Rmd</code>:</p> <ul> <li><code>params$out_dir</code> (default: <code>output/</code>) This makes the workflow reproducible because you can re-run the pipeline and compare the saved artifacts.</li> </ul>"},{"location":"outputs/#output-directory-structure","title":"Output directory structure","text":"<p>After a successful run, you should see files like:</p> <ul> <li> <p><code>output/seurat_obj.rds</code>   Final Seurat object after preprocessing, clustering, and (if enabled) annotation.</p> </li> <li> <p><code>output/markers_all.csv</code>   Full marker table from <code>Seurat::FindAllMarkers()</code>.</p> </li> <li> <p><code>output/markers_top.csv</code>   Top N marker genes per cluster (N controlled by <code>params$top_n_markers</code>).</p> </li> <li> <p><code>output/elbow.png</code>   Elbow plot for PCA variance (helps choose number of PCs).</p> </li> <li> <p><code>output/umap_clusters.png</code>   UMAP plot colored by Seurat clusters.</p> </li> <li> <p><code>output/sessionInfo.txt</code>   The R session information (R version + package versions) used for the run.</p> </li> </ul> <p>Note: If you add more plots (e.g., annotated UMAP), they can be added to the <code>plots = list(...)</code> argument in <code>save_outputs()</code>.</p>"},{"location":"outputs/#how-to-verify-the-run-worked","title":"How to verify the run worked?","text":"<ol> <li>Plots exist and look reasonable</li> <li><code>elbow.png</code> shows a clear \u201celbow\u201d or diminishing variance after some PCs.</li> <li> <p><code>umap_clusters.png</code> shows separated clusters (not all cells overlapping).</p> </li> <li> <p>Marker tables are non-empty</p> </li> <li><code>markers_all.csv</code> should contain many rows (marker genes across clusters).</li> <li> <p><code>markers_top.csv</code> should contain <code>top_n_markers \u00d7 (#clusters)</code> rows (approximately).</p> </li> <li> <p>The Seurat object can be reloaded    In R:    ```r    seu &lt;- readRDS(\"output/seurat_obj.rds\")    seu</p> </li> </ol>"},{"location":"reproduce/","title":"Reproduce / Run the workflow","text":""},{"location":"reproduce/#recommended-render-the-report","title":"Recommended: render the report","text":"<p>From the project root:</p> <p>```r rmarkdown::render(\"main.Rmd\")</p>"},{"location":"scripts/","title":"Scripts","text":"<p>The pipeline logic is split into small scripts under <code>R scripts/</code> and orchestrated by <code>main.Rmd</code>.</p>"},{"location":"scripts/#mainrmd","title":"<code>main.Rmd</code>","text":"<ul> <li>Orchestrates the pipeline</li> <li>Controls parameters via YAML <code>params</code></li> <li>Optionally runs unit tests (<code>run_tests: true</code>)</li> <li>Produces the final analysis report (HTML)</li> </ul>"},{"location":"scripts/#r-scriptsload_datar","title":"<code>R scripts/load_data.R</code>","text":"<p>Purpose: - Load Monocle3 <code>cell_data_set</code> from a directory</p> <p>Main function: - <code>load_monocle_objects(dir_path)</code></p>"},{"location":"scripts/#r-scriptsconvertr","title":"<code>R scripts/convert.R</code>","text":"<p>Purpose: - Convert Monocle3 object to Seurat object</p> <p>Main function: - <code>monocle_to_seurat(cds, project_name=...)</code></p>"},{"location":"scripts/#r-scriptspreprocess_clusterr","title":"<code>R scripts/preprocess_cluster.R</code>","text":"<p>Purpose: - Preprocessing and clustering steps</p> <p>Main functions: - <code>run_preprocess(seu, npcs=...)</code> - <code>run_cluster_umap(seu, dims=..., resolution=...)</code></p>"},{"location":"scripts/#r-scriptsmarkersr","title":"<code>R scripts/markers.R</code>","text":"<p>Purpose: - Marker gene identification and selection of top markers</p> <p>Main functions: - <code>find_markers(seu, min_pct=..., logfc_threshold=...)</code> - <code>top_markers(markers_df, n=...)</code></p>"},{"location":"scripts/#r-scriptsannotate_saver","title":"<code>R scripts/annotate_save.R</code>","text":"<p>Purpose: - Cluster annotation and output saving</p> <p>Main functions: - <code>annotate_clusters(seu, mapping, label_col=...)</code> - <code>save_outputs(seu, markers, top_markers, out_dir, plots=...)</code></p>"},{"location":"steps/","title":"Pipeline steps","text":"<p>This page describes what each pipeline step does, its inputs/outputs, and where it is implemented.</p>"},{"location":"steps/#step-1-load-monocle3-object","title":"Step 1 \u2014 Load Monocle3 object","text":"<p>Goal: load the dataset into R as a <code>cell_data_set</code></p> <ul> <li>Input: <code>data/embryo_11dpf/cds_object.rds</code></li> <li>Output: <code>cds</code> (Monocle3 object)</li> </ul> <p>Implemented in: - <code>R scripts/load_data.R</code> \u2192 <code>load_monocle_objects()</code></p>"},{"location":"steps/#step-2-convert-to-seurat","title":"Step 2 \u2014 Convert to Seurat","text":"<p>Goal: convert Monocle3 object to a Seurat object for downstream analysis.</p> <ul> <li>Input: <code>cds</code> (<code>cell_data_set</code>)</li> <li>Output: <code>seurat_obj_11dpf</code> (Seurat object)</li> </ul> <p>Implemented in: - <code>R scripts/convert.R</code> \u2192 <code>monocle_to_seurat()</code></p>"},{"location":"steps/#step-3-preprocess-pca","title":"Step 3 \u2014 Preprocess + PCA","text":"<p>Goal: normalize and reduce dimensionality.</p> <ul> <li>SCTransform normalization</li> <li> <p>PCA (Principal Component Analysis)</p> </li> <li> <p>Input: Seurat object with raw counts</p> </li> <li>Output: Seurat object with <code>SCT</code> assay + PCA reduction</li> </ul> <p>Implemented in: - <code>R scripts/preprocess_cluster.R</code> \u2192 <code>run_preprocess()</code></p> <p>Key parameters in <code>main.Rmd</code>: - <code>npcs</code> (number of PCs computed) - <code>elbow_ndims</code> (how many PCs shown in elbow plot)</p>"},{"location":"steps/#step-4-clustering-umap","title":"Step 4 \u2014 Clustering + UMAP","text":"<p>Goal: identify clusters and visualize them.</p> <ul> <li>FindNeighbors (using selected PCs)</li> <li>FindClusters (resolution controls cluster granularity)</li> <li>RunUMAP for visualization</li> </ul> <p>Outputs: - Seurat object with <code>seurat_clusters</code> - UMAP plot (cluster labels)</p> <p>Implemented in: - <code>R scripts/preprocess_cluster.R</code> \u2192 <code>run_cluster_umap()</code></p> <p>Key parameters: - <code>dims_use</code> (number of PCs used) - <code>resolution</code> (clustering resolution)</p>"},{"location":"steps/#step-5-marker-genes","title":"Step 5 \u2014 Marker genes","text":"<p>Goal: find genes enriched in each cluster (cluster markers).</p> <ul> <li>Input: clustered Seurat object</li> <li>Output: <code>markers</code> (full table) and <code>top_markers</code> (top N per cluster)</li> </ul> <p>Implemented in: - <code>R scripts/markers.R</code> \u2192 <code>find_markers()</code>, <code>top_markers()</code></p> <p>Key parameters: - <code>min_pct</code> - <code>logfc_threshold</code> - <code>top_n_markers</code></p>"},{"location":"steps/#step-6-cell-type-annotation","title":"Step 6 \u2014 Cell type annotation","text":"<p>Goal: assign interpretable labels to clusters using a mapping.</p> <ul> <li>Input: Seurat clusters (0..9 in this dataset)</li> <li>Output: <code>New_ident</code> identity + annotated UMAP plot</li> </ul> <p>Implemented in: - <code>R scripts/annotate_save.R</code> \u2192 <code>annotate_clusters()</code></p> <p>Notes: - This step uses a manual mapping: cluster ID \u2192 label. - Unmapped clusters (if any) can be labeled as \u201cUnknown\u201d.</p>"},{"location":"steps/#step-7-save-outputs","title":"Step 7 \u2014 Save outputs","text":"<p>Goal: save results to <code>output/</code> so the run is reproducible.</p> <p>Saves: - Seurat object (<code>.rds</code>) - marker tables (<code>.csv</code>) - plots (<code>.png</code>) - <code>sessionInfo.txt</code></p> <p>Implemented in: - <code>R scripts/annotate_save.R</code> \u2192 <code>save_outputs()</code></p>"},{"location":"steps/#optional-future-extension-trajectory-pseudotime-analysis","title":"Optional / future extension: trajectory (pseudotime) analysis","text":"<p>This project\u2019s current reproducible workflow focuses on: - preprocessing (SCTransform + PCA), - clustering + UMAP visualization, - marker gene identification, - and manual cluster-to-cell-type annotation.</p> <p>A future extension of this workflow is trajectory (pseudotime) analysis, which is useful when cells can be ordered along a developmental or differentiation progression (for example, across developmental timepoints such as 11 dpf and other stages).</p>"},{"location":"steps/#planned-approach","title":"Planned approach","text":"<ul> <li>Use Monocle3 trajectory learning (graph-based trajectory inference) or Seurat + Monocle3 integration.</li> <li>Leverage PCA/UMAP embeddings and/or selected features to learn a trajectory graph.</li> <li>Assign pseudotime values to cells and visualize gene expression changes along pseudotime.</li> </ul>"},{"location":"steps/#expected-outputs-when-implemented","title":"Expected outputs (when implemented)","text":"<ul> <li>Trajectory graph visualization</li> <li>Pseudotime values per cell (table)</li> <li>Pseudotime heatmaps / gene trends for marker genes of interest</li> </ul>"},{"location":"steps/#notes","title":"Notes","text":"<p>Trajectory inference is not always appropriate for every dataset (e.g., if the biology is not continuous or if batch effects dominate). If added, the workflow will document assumptions and include sanity checks to confirm a meaningful trajectory signal.</p>"},{"location":"tests/","title":"Tests","text":"<p>This project uses R package testthat to test key functions in the pipeline.</p>"},{"location":"tests/#where-tests-live","title":"Where tests live","text":"<p>Tests are located in:</p> <p><code>tests/testthat/</code></p> <p>Example files: - <code>test-load_data.R</code> - <code>test-convert.R</code> - <code>test-annotate_save.R</code> (Additional tests can be added as the workflow grows.)</p>"},{"location":"tests/#what-is-tested","title":"What is tested","text":"<p>The tests are lightweight and designed to run quickly. They verify that:</p> <ul> <li>Loading a <code>cell_data_set</code> from <code>cds_object.rds</code> works</li> <li>Converting Monocle3 \u2192 Seurat produces a valid Seurat object</li> <li>Annotation adds the expected metadata column / identity</li> <li>Saving outputs creates expected files</li> </ul>"},{"location":"tests/#how-to-run-tests","title":"How to run tests","text":""},{"location":"tests/#run-tests-directly-in-r","title":"Run tests directly in R","text":"<p>```r testthat::test_dir(\"tests/testthat\", reporter = \"summary\")</p>"},{"location":"workflow/","title":"Workflow","text":"<p>This project is a reproducible single-cell RNA-seq (scRNA-seq) analysis workflow built in R using:</p> <ul> <li>monocle3 for the input data format (<code>cell_data_set</code>)</li> <li>Seurat for normalization, dimensionality reduction, clustering, marker detection, and visualization</li> <li>testthat for unit tests</li> </ul>"},{"location":"workflow/#acyclic-data-flow","title":"Acyclic data flow","text":"<p>The workflow is acyclic (directed acyclic graph / DAG): each step takes inputs and produces outputs that are used downstream, without looping back to earlier steps.</p> <p>High-level flow:</p> <ol> <li>Input data (Monocle3 <code>cell_data_set</code>)  </li> <li>Convert to Seurat object  </li> <li>Preprocess (SCTransform, PCA)  </li> <li>Cluster + UMAP </li> <li>Marker genes </li> <li>Cell type annotation (mapping clusters \u2192 labels)  </li> <li>Save outputs (plots, tables, objects, session info)</li> </ol>"},{"location":"workflow/#inputs-and-outputs","title":"Inputs and outputs","text":"<ul> <li>Input: <code>data/embryo_11dpf/</code> (contains <code>cds_object.rds</code>)</li> <li>Outputs: <code>output/</code> (CSV marker tables, PNG plots, Seurat object <code>.rds</code>, session info)</li> <li>Documentation site: <code>docs/</code> rendered by MkDocs</li> <li>Tests: <code>tests/testthat/</code></li> </ul>"}]}