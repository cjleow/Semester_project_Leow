
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../inputs/">
      
      
        <link rel="next" href="../scripts/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Pipeline Steps - Leow scRNA-seq Workflow</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pipeline-steps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Leow scRNA-seq Workflow" class="md-header__button md-logo" aria-label="Leow scRNA-seq Workflow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Leow scRNA-seq Workflow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pipeline Steps
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Leow scRNA-seq Workflow" class="md-nav__button md-logo" aria-label="Leow scRNA-seq Workflow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Leow scRNA-seq Workflow
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inputs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Pipeline Steps
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Pipeline Steps
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-load-monocle3-object" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 — Load Monocle3 object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-convert-to-seurat" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 — Convert to Seurat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-preprocess-pca" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 — Preprocess + PCA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-clustering-umap" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 — Clustering + UMAP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-marker-genes" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5 — Marker genes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-cell-type-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6 — Cell type annotation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-save-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7 — Save outputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-future-extension-trajectory-pseudotime-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Optional / future extension: trajectory (pseudotime) analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optional / future extension: trajectory (pseudotime) analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planned-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Planned approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expected-outputs-when-implemented" class="md-nav__link">
    <span class="md-ellipsis">
      Expected outputs (when implemented)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tests
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../outputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outputs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reproduce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reproduce
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-load-monocle3-object" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 — Load Monocle3 object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-convert-to-seurat" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 — Convert to Seurat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-preprocess-pca" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 — Preprocess + PCA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-clustering-umap" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 — Clustering + UMAP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-marker-genes" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5 — Marker genes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-cell-type-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6 — Cell type annotation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-save-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7 — Save outputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-future-extension-trajectory-pseudotime-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Optional / future extension: trajectory (pseudotime) analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optional / future extension: trajectory (pseudotime) analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planned-approach" class="md-nav__link">
    <span class="md-ellipsis">
      Planned approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expected-outputs-when-implemented" class="md-nav__link">
    <span class="md-ellipsis">
      Expected outputs (when implemented)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="pipeline-steps">Pipeline steps</h1>
<p>This page describes what each pipeline step does, its inputs/outputs, and where it is implemented.</p>
<h2 id="step-1-load-monocle3-object">Step 1 — Load Monocle3 object</h2>
<p><strong>Goal:</strong> load the dataset into R as a <code>cell_data_set</code></p>
<ul>
<li>Input: <code>data/embryo_11dpf/cds_object.rds</code></li>
<li>Output: <code>cds</code> (Monocle3 object)</li>
</ul>
<p>Implemented in:
- <code>R scripts/load_data.R</code> → <code>load_monocle_objects()</code></p>
<h2 id="step-2-convert-to-seurat">Step 2 — Convert to Seurat</h2>
<p><strong>Goal:</strong> convert Monocle3 object to a Seurat object for downstream analysis.</p>
<ul>
<li>Input: <code>cds</code> (<code>cell_data_set</code>)</li>
<li>Output: <code>seurat_obj_11dpf</code> (Seurat object)</li>
</ul>
<p>Implemented in:
- <code>R scripts/convert.R</code> → <code>monocle_to_seurat()</code></p>
<h2 id="step-3-preprocess-pca">Step 3 — Preprocess + PCA</h2>
<p><strong>Goal:</strong> normalize and reduce dimensionality.</p>
<ul>
<li>SCTransform normalization</li>
<li>
<p>PCA (Principal Component Analysis)</p>
</li>
<li>
<p>Input: Seurat object with raw counts</p>
</li>
<li>Output: Seurat object with <code>SCT</code> assay + PCA reduction</li>
</ul>
<p>Implemented in:
- <code>R scripts/preprocess_cluster.R</code> → <code>run_preprocess()</code></p>
<p>Key parameters in <code>main.Rmd</code>:
- <code>npcs</code> (number of PCs computed)
- <code>elbow_ndims</code> (how many PCs shown in elbow plot)</p>
<h2 id="step-4-clustering-umap">Step 4 — Clustering + UMAP</h2>
<p><strong>Goal:</strong> identify clusters and visualize them.</p>
<ul>
<li>FindNeighbors (using selected PCs)</li>
<li>FindClusters (resolution controls cluster granularity)</li>
<li>RunUMAP for visualization</li>
</ul>
<p>Outputs:
- Seurat object with <code>seurat_clusters</code>
- UMAP plot (cluster labels)</p>
<p>Implemented in:
- <code>R scripts/preprocess_cluster.R</code> → <code>run_cluster_umap()</code></p>
<p>Key parameters:
- <code>dims_use</code> (number of PCs used)
- <code>resolution</code> (clustering resolution)</p>
<h2 id="step-5-marker-genes">Step 5 — Marker genes</h2>
<p><strong>Goal:</strong> find genes enriched in each cluster (cluster markers).</p>
<ul>
<li>Input: clustered Seurat object</li>
<li>Output: <code>markers</code> (full table) and <code>top_markers</code> (top N per cluster)</li>
</ul>
<p>Implemented in:
- <code>R scripts/markers.R</code> → <code>find_markers()</code>, <code>top_markers()</code></p>
<p>Key parameters:
- <code>min_pct</code>
- <code>logfc_threshold</code>
- <code>top_n_markers</code></p>
<h2 id="step-6-cell-type-annotation">Step 6 — Cell type annotation</h2>
<p><strong>Goal:</strong> assign interpretable labels to clusters using a mapping.</p>
<ul>
<li>Input: Seurat clusters (0..9 in this dataset)</li>
<li>Output: <code>New_ident</code> identity + annotated UMAP plot</li>
</ul>
<p>Implemented in:
- <code>R scripts/annotate_save.R</code> → <code>annotate_clusters()</code></p>
<p>Notes:
- This step uses a manual mapping: cluster ID → label.
- Unmapped clusters (if any) can be labeled as “Unknown”.</p>
<h2 id="step-7-save-outputs">Step 7 — Save outputs</h2>
<p><strong>Goal:</strong> save results to <code>output/</code> so the run is reproducible.</p>
<p>Saves:
- Seurat object (<code>.rds</code>)
- marker tables (<code>.csv</code>)
- plots (<code>.png</code>)
- <code>sessionInfo.txt</code></p>
<p>Implemented in:
- <code>R scripts/annotate_save.R</code> → <code>save_outputs()</code></p>
<h2 id="optional-future-extension-trajectory-pseudotime-analysis">Optional / future extension: trajectory (pseudotime) analysis</h2>
<p>This project’s current reproducible workflow focuses on:
- preprocessing (SCTransform + PCA),
- clustering + UMAP visualization,
- marker gene identification,
- and manual cluster-to-cell-type annotation.</p>
<p>A future extension of this workflow is <strong>trajectory (pseudotime) analysis</strong>, which is useful when cells can be ordered along a developmental or differentiation progression (for example, across developmental timepoints such as 11 dpf and other stages).</p>
<h3 id="planned-approach">Planned approach</h3>
<ul>
<li>Use Monocle3 trajectory learning (graph-based trajectory inference) or Seurat + Monocle3 integration.</li>
<li>Leverage PCA/UMAP embeddings and/or selected features to learn a trajectory graph.</li>
<li>Assign pseudotime values to cells and visualize gene expression changes along pseudotime.</li>
</ul>
<h3 id="expected-outputs-when-implemented">Expected outputs (when implemented)</h3>
<ul>
<li>Trajectory graph visualization</li>
<li>Pseudotime values per cell (table)</li>
<li>Pseudotime heatmaps / gene trends for marker genes of interest</li>
</ul>
<h3 id="notes">Notes</h3>
<p>Trajectory inference is not always appropriate for every dataset (e.g., if the biology is not continuous or if batch effects dominate). If added, the workflow will document assumptions and include sanity checks to confirm a meaningful trajectory signal.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>