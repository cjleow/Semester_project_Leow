scRNAseq_Analysis_Pipeline

Input:
    sc_RNA_data <- single-cell RNA-seq data from collaborators

Begin

    # Step 1: Obtain experimental data
    Receive(sc_RNA_data)

    # Step 2: Download data
    sc_RNA_object <- Download(sc_RNA_data) as monocle3_object

    # Step 3: Store on HPCC
    Upload(sc_RNA_object, destination = "HPCC")

    # Step 4: Extract data using Seurat in R
    count_data <- ExtractCounts(sc_RNA_object)
    metadata   <- ExtractMetadata(sc_RNA_object)

    # Step 5: Perform single-cell analysis
    seurat_obj <- CreateSeuratObject(count_data, metadata)
    Normalize(seurat_obj)
    ScaleData(seurat_obj)
    RunPCA(seurat_obj)
    PlotElbow(seurat_obj)
    BatchCorrect(seurat_obj)
    neighbors <- FindNeighbors(seurat_obj)
    clusters  <- ClusterCells(seurat_obj, method = "Leiden")
    marker_genes <- IdentifyMarkers(clusters)
    Visualize(seurat_obj, method = "UMAP")

    # Step 6: Save outputs
    Save(DEGs_table, HPCC)
    Save(UMAP_plot, HPCC)
    Save(PCA_embeddings, HPCC)

    # Step 7: Trajectory or pseudotime analysis
    trajectory_graph <- PerformTrajectoryAnalysis(PCA_embeddings)
    Save(trajectory_graph, HPCC)

Overall output:
    DEGs_table          <- Differentially expressed genes
    UMAP_plot            <- Cluster visualization
    PCA_embeddings       <- Clustered single-cell data
    trajectory_graph     <- Pseudotime analysis result

End
